{
    "sourceFile": "resources/views/admin/employee/editProfile.blade.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1736139439269,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1736139453946,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,386 @@\n+<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css\">\n+<link href=\"https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css\" rel=\"stylesheet\">\n+<link rel=\"stylesheet\" href=\"{{ asset('admin/css/employee/style_edit.css') }}\">\n+<link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>\n+\n+<script src=\"https://cdn.jsdelivr.net/npm/sweetalert2@11\"></script>\n+\n+\n+<body>\n+    <div class=\"container\">\n+        <h1 style=\"text-align: left\">Chỉnh sửa thông tin hồ sơ</h1>\n+        <form id=\"updateProfile\" action=\"{{ route('employee.updateProfile') }}\" method=\"POST\" enctype=\"multipart/form-data\">\n+            @csrf\n+            @method('PUT')\n+            <!-- Cột bên trái (3/4) và cột bên phải (1/4) -->\n+            <div class=\"row mb-3\">\n+                <!-- Cột bên trái -->\n+                <div class=\"col-md-9\">\n+                    <!-- Mã KH + Mã số thuế + Tên KH -->\n+                    <div class=\"row mb-3\">\n+                        <div class=\"form-group col-md-4\">\n+                            <label for=\"username\" class=\"form-label\">Tên tài khoản<span class=\"required\">*</span></label>\n+                            <input type=\"text\" id=\"username\" name=\"username\" class=\"form-control\"\n+                                value=\"{{ $logged_user->user->username }}\" required>\n+                            <span class=\"error-message\" id=\"username_error\"></span>\n+                        </div>\n+                        <div class=\"form-group col-md-4\">\n+                            <label for=\"full_name\" class=\"form-label\">Tên nhân viên<span class=\"required\">*</span></label>\n+                            <input type=\"text\" id=\"full_name\" name=\"full_name\" class=\"form-control\"\n+                                value=\"{{ $logged_user->full_name }}\" required>\n+                            <span class=\"error-message\" id=\"full_name_error\"></span>\n+                        </div>\n+                        <div class=\"form-group col-md-4\">\n+                            <label for=\"gender\" class=\"form-label\">Giới tính<span class=\"required\">*</span></label>\n+                            <select id=\"gender\" name=\"gender\" class=\"form-control\" required>\n+                                <option value=\"Nam\" {{ $logged_user->gender == 'Nam' ? 'selected' : '' }}>Nam</option>\n+                                <option value=\"Nữ\" {{ $logged_user->gender == 'Nữ' ? 'selected' : '' }}>Nữ</option>\n+                            </select>\n+                        </div>\n+                    </div>\n+\n+                    <div class=\"row mb-3\">\n+                        <div class=\"form-group col-md-6 form-group-2\">\n+                            <label for=\"date_of_birth\" class=\"form-label\">Ngày sinh<span class=\"required\">*</span></label>\n+                            <input type=\"date\" id=\"date_of_birth\" name=\"date_of_birth\" class=\"form-control\"\n+                                value=\"{{ $logged_user->date_of_birth->toDateString() }}\" required>\n+                            <span class=\"error-message\" id=\"date_of_birth_error\"></span>\n+                        </div>\n+                        <div class=\"form-group col-md-6 form-group-2\">\n+                            <label for=\"phone\" class=\"form-label\">Số điện thoại<span class=\"required\">*</span></label>\n+                            <input type=\"text\" id=\"phone\" name=\"phone\" class=\"form-control\"\n+                                value=\"{{ $logged_user->phone }}\" required>\n+                            <span class=\"error-message\" id=\"phone_error\"></span>\n+                        </div>\n+\n+                    </div>\n+                    <div class=\"row mb-3\">\n+                        <div class=\"form-group col-md-6 form-group-3\">\n+                            <label for=\"email\" class=\"form-label\">Email<span class=\"required\">*</span></label>\n+                            <input type=\"text\" id=\"email\" name=\"email\" class=\"form-control\"\n+                                value=\"{{ $logged_user->email }}\" required>\n+                            <span class=\"error-message\" id=\"email_error\"></span>\n+                        </div>\n+                        <div class=\"form-group col-md-6 form-group-3\">\n+                            <label for=\"address\" class=\"form-label\">Địa chỉ<span class=\"required\">*</span></label>\n+                            <input type=\"text\" id=\"address\" name=\"address\" class=\"form-control\"\n+                                value=\"{{ $logged_user->address }}\" required>\n+                            <span class=\"error-message\" id=\"address_error\"></span>\n+                        </div>\n+                    </div>\n+                </div>\n+\n+                <!-- Cột bên phải cho hình ảnh đại diện -->\n+                <div class=\"col-md-3\">\n+                    <div class=\"container-img\">\n+                        <div class=\"form-group\">\n+                            <label for=\"profile_image\" class=\"form-label profile-image-label\">Ảnh đại diện</label>\n+                            <div class=\"custom-file-upload\">\n+                                <input type=\"file\" id=\"profile_image\" name=\"profile_image\" class=\"form-control\"\n+                                    accept=\"image/*\" onchange=\"previewImage(event)\">\n+                                <label for=\"profile_image\" class=\"custom-file-label\">Chọn khác</label>\n+\n+                                <div class=\"image-preview\">\n+                                    <div id=\"image-preview\" class=\"image-preview\">\n+                                        <img id=\"preview-img\"\n+                                            src=\"{{ $logged_user->profile_image ? asset('admin/img/employee/' . $logged_user->profile_image) : asset('admin/img/customer/default.png') }}\"\n+                                            alt=\"Hình đại diện\">\n+                                    </div>\n+                                </div>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </div>\n+            </div>\n+            <!-- Nút hành động -->\n+            <div class=\"button-container\">\n+                <button type=\"submit\" class=\"btn btn-edit me-3\">Cập nhật</button>\n+                <div class=\"btn btn-edit me-3\" id=\"openForm\">Thay đổi mật khẩu</div>\n+                <a href=\"{{ route('dashboard.index') }}\" class=\"btn btn-secondary\">Hủy</a>\n+            </div>\n+        </form>\n+    </div>\n+    <div class=\"modal-overlay\" id=\"modalOverlay\"></div>\n+    <div class=\"modal reset-password-box\" id=\"registrationForm\">\n+        <div class=\"reset-password-header\">\n+            <span>Đổi mật khẩu</span>\n+        </div>\n+        <form action=\"{{ route('employee.changePass') }}\" method=\"POST\" enctype=\"multipart/form-data\" class=\"reset-password-form\">\n+            @csrf\n+            @method('PUT')\n+\n+            <div class=\"input_box\">\n+                <input type=\"password\" name=\"old-password\" id=\"old-password\" class=\"input-field\" required>\n+                <label for=\"old-password\" class=\"label\">Mật khẩu cũ</label>\n+                <i class=\"bx bx-show toggle-password icon\" data-target=\"old-password\"></i>\n+                @if ($errors->has('old-password'))\n+                <div class=\"error-message\">{{ $errors->first('old-password') }}</div>\n+                @endif\n+            </div>\n+\n+            <div class=\"input_box\">\n+                <input type=\"password\" name=\"new-password\" id=\"new-password\" class=\"input-field\" value=\"{{ old('new-password') }}\" required>\n+                <label for=\"new-password\" class=\"label\">Mật khẩu mới</label>\n+                <i class=\"bx bx-show toggle-password icon\" data-target=\"new-password\"></i>\n+                <span class=\"error-message\" id=\"password_error\"></span>\n+                <div class=\"password-hint\">\n+                    <strong class=\"strong1\">Gợi ý để tạo mật khẩu an toàn:</strong>\n+                    <div class=\"hint-list\">\n+                        <ul class=\"ul-hint-list\">\n+                            <li class=\"hint\" id=\"hint_length\">Tối thiểu 8 ký tự</li>\n+                            <li class=\"hint\" id=\"hint_uppercase\">1 chữ cái in hoa</li>\n+                            <li class=\"hint\" id=\"hint_number\">1 số</li>\n+                            <li class=\"hint\" id=\"hint_special\">1 ký tự đặc biệt</li>\n+                            <li class=\"hint\" id=\"hint_lowercase\">1 chữ thường</li>\n+                        </ul>\n+                    </div>\n+                </div>\n+            </div>\n+\n+            <!-- Confirm Password -->\n+            <div class=\"input_box\">\n+                <input type=\"password\" name=\"confirm-password\" id=\"confirm-password\" class=\"input-field\" value=\"{{ old('confirm-password') }}\" required>\n+                <label for=\"confirm-password\" class=\"label\">Xác nhận mật khẩu</label>\n+                <i class=\"bx bx-show toggle-password icon\" data-target=\"confirm-password\"></i>\n+                <span class=\"error-message\" id=\"password_confirm_error\"></span>\n+            </div>\n+\n+            <!-- Submit Button -->\n+            <div class=\"input_box\">\n+                <input type=\"submit\" class=\"input-submit\" value=\"Cập nhật mật khẩu\">\n+            </div>\n+        </form>\n+    </div>\n+</body>\n+\n+<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js\"></script>\n+<script>\n+    function previewImage(event) {\n+        var reader = new FileReader();\n+        reader.onload = function() {\n+            var output = document.getElementById('preview-img');\n+            output.src = reader.result;\n+            output.style.display = 'block';\n+        };\n+        reader.readAsDataURL(event.target.files[0]);\n+    }\n+    @if(session('success'))\n+    document.addEventListener('DOMContentLoaded', function() {\n+        Swal.fire({\n+            title: 'Thành công!',\n+            text: \"{{ session('success') }}\",\n+            icon: 'success',\n+            confirmButtonText: 'OK'\n+        });\n+    });\n+    @endif\n+    document.addEventListener('DOMContentLoaded', function() {\n+        // Hiển thị modal nếu có lỗi từ server\n+        if (\"{{ $errors->any() }}\") {\n+            document.getElementById('registrationForm').style.display = 'block';\n+            document.getElementById('modalOverlay').style.display = 'block';\n+        }\n+\n+        const passwordInput = document.getElementById('new-password');\n+        const savedPassword = \"{{ old('new-password') }}\";\n+        const passwordConfirmInput = document.getElementById('confirm-password');\n+        const form = document.querySelector('.reset-password-form');\n+\n+        if (savedPassword) {\n+            updateHints(savedPassword);\n+        }\n+\n+        // Cập nhật gợi ý khi người dùng nhập mật khẩu mới\n+        passwordInput.addEventListener('input', function() {\n+            const passwordValue = passwordInput.value;\n+            updateHints(passwordValue);\n+        });\n+\n+        form.addEventListener('submit', function(e) {\n+            e.preventDefault();\n+            let hasError = false;\n+            // Password validation\n+            if (passwordInput.value.length < 8 || !/[A-Z]/.test(passwordInput.value) || !/[0-9]/.test(passwordInput.value) || !/[!@#$%^&*]/.test(passwordInput.value)) {\n+                document.getElementById('password_error').textContent = 'Mật khẩu yếu: phải chứa ít nhất 8 ký tự bao gồm chữ in hoa, số và ký tự đặc biệt.';\n+                hasError = true;\n+            }\n+\n+            // Password confirmation validation\n+            if (passwordInput.value !== passwordConfirmInput.value) {\n+                document.getElementById('password_confirm_error').textContent = 'Mật khẩu xác nhận không khớp.';\n+                hasError = true;\n+            }\n+\n+            // Nếu không có lỗi thì gửi form\n+            if (!hasError) {\n+                form.submit();\n+            }\n+        });\n+    });\n+    const openFormButton = document.getElementById('openForm');\n+    const modalPass = document.getElementById('registrationForm');\n+    const overlay = document.getElementById('modalOverlay');\n+    openFormButton.addEventListener('click', () => {\n+        modalPass.style.display = 'block';\n+        overlay.style.display = 'block';\n+\n+    });\n+\n+    overlay.addEventListener('click', () => {\n+        modalPass.style.display = 'none';\n+        overlay.style.display = 'none';\n+        const inputs = modalPass.querySelectorAll(\"input\");\n+        inputs.forEach(input => {\n+            if (input.type === \"submit\") {\n+                return;\n+            } else {\n+                input.value = \"\";\n+            }\n+        });\n+    });\n+\n+    document.querySelectorAll('.toggle-password').forEach(icon => {\n+        icon.addEventListener('click', () => {\n+            const targetId = icon.getAttribute('data-target');\n+            const targetInput = document.getElementById(targetId);\n+\n+            if (targetInput.type === 'password') {\n+                targetInput.type = 'text';\n+                icon.classList.remove('bx-show');\n+                icon.classList.add('bx-hide');\n+            } else {\n+                targetInput.type = 'password';\n+                icon.classList.remove('bx-hide');\n+                icon.classList.add('bx-show');\n+            }\n+        });\n+    });\n+\n+    function updateHints(passwordValue) {\n+        const errorMessage = document.getElementById('password_error');\n+\n+        // Reset màu sắc gợi ý\n+        document.querySelectorAll('.hint').forEach(hint => {\n+            hint.style.color = 'black';\n+        });\n+\n+        // Thay đổi màu sắc dựa trên điều kiện\n+        if (passwordValue.length >= 8) {\n+            document.getElementById('hint_length').style.color = 'orange';\n+        }\n+        if (/[A-Z]/.test(passwordValue)) {\n+            document.getElementById('hint_uppercase').style.color = 'orange';\n+        }\n+        if (/[0-9]/.test(passwordValue)) {\n+            document.getElementById('hint_number').style.color = 'orange';\n+        }\n+        if (/[!@#$%^&*]/.test(passwordValue)) {\n+            document.getElementById('hint_special').style.color = 'orange';\n+        }\n+        if (/[a-z]/.test(passwordValue)) {\n+            document.getElementById('hint_lowercase').style.color = 'orange';\n+        }\n+\n+        // Hiển thị thông báo lỗi nếu không đạt\n+        if (passwordValue.length < 8) {\n+            errorMessage.textContent = 'Mật khẩu phải có ít nhất 8 ký tự.';\n+        } else if (!/[A-Z]/.test(passwordValue)) {\n+            errorMessage.textContent = 'Mật khẩu phải có ít nhất một chữ cái viết hoa.';\n+        } else if (!/[0-9]/.test(passwordValue)) {\n+            errorMessage.textContent = 'Mật khẩu phải có ít nhất một số.';\n+        } else if (!/[!@#$%^&*]/.test(passwordValue)) {\n+            errorMessage.textContent = 'Mật khẩu phải có ít nhất một ký tự đặc biệt.';\n+        } else {\n+            errorMessage.textContent = '';\n+        }\n+    }\n+</script>\n+\n+<script>\n+    document.addEventListener('DOMContentLoaded', function() {\n+        const fullNameInput = document.getElementById('full_name');\n+        const phoneInput = document.getElementById('phone');\n+        const addressInput = document.getElementById('address');\n+        const dateOfBirthInput = document.getElementById('date_of_birth');\n+        const emailInput = document.getElementById('email');\n+        const usernameInput = document.getElementById('username');\n+        const form = document.getElementById('updateProfile');\n+\n+        function isValidEmail(email) {\n+            const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n+            return emailRegex.test(email);\n+        }\n+\n+        form.addEventListener('submit', function(e) {\n+            e.preventDefault();\n+            let hasError = false;\n+\n+            document.querySelectorAll('.error-message').forEach(error => {\n+                error.textContent = '';\n+            });\n+\n+            if (!/^[a-zA-ZÀ-ỹ\\s]+$/.test(fullNameInput.value.trim())) {\n+                document.getElementById('full_name_error').textContent = 'Họ và tên không được chứa số hoặc ký tự đặc biệt.';\n+                hasError = true;\n+            }\n+\n+            if (!/^\\d{10}$/.test(phoneInput.value.trim())) {\n+                document.getElementById('phone_error').textContent = 'Số điện thoại phải gồm 10 chữ số.';\n+                hasError = true;\n+            }\n+\n+            const dobValue = dateOfBirthInput.value;\n+            const [year, month, day] = dobValue.split('-').map(Number);\n+\n+            if (!year || !month || !day) {\n+                document.getElementById('date_of_birth_error').textContent = 'Vui lòng nhập đầy đủ ngày, tháng, năm.';\n+                hasError = true;\n+            } else if (year < 1900) {\n+                document.getElementById('date_of_birth_error').textContent = 'Năm sinh không hợp lệ (phải từ 1900 trở đi).';\n+                hasError = true;\n+            }\n+\n+            if (/^\\d+$/.test(addressInput.value.trim())) {\n+                document.getElementById('address_error').textContent = 'Địa chỉ không được chứa toàn là số.';\n+                hasError = true;\n+            }\n+\n+            if (!isValidEmail(emailInput.value.trim())) {\n+                document.getElementById('email_error').textContent = 'Email không hợp lệ.';\n+                hasError = true;\n+            }\n+\n+            if (!/^[a-zA-Z0-9]+$/.test(usernameInput.value.trim())) {\n+                document.getElementById('username_error').textContent = 'Tên đăng nhập chỉ được chứa chữ cái và số, không chứa dấu câu.';\n+                hasError = true;\n+            }\n+\n+            Promise.all([\n+                fetch(\"{{ route('resendOtp', ${emailInput.value.trim()}) }}\")\n+                .then(response => response.json())\n+                .then(data => {\n+                    if (data.exists) {\n+                        document.getElementById('email_error').textContent = 'Email đã tồn tại trong hệ thống. Vui lòng sử dụng email khác.';\n+                        hasError = true;\n+                    }\n+                }),\n+\n+                fetch(`/check-username-employee/${usernameInput.value.trim()}`)\n+                .then(response => response.json())\n+                .then(data => {\n+                    if (data.exists) {\n+                        document.getElementById('username_error').textContent = 'Tên đăng nhập đã tồn tại, vui lòng chọn tên khác.';\n+                        hasError = true;\n+                    }\n+                })\n+            ]).then(() => {\n+                if (!hasError) {\n+                    form.submit();\n+                }\n+            }).catch(error => {\n+                console.error('Lỗi khi kiểm tra thông tin:', error);\n+            });\n+\n+        });\n+    });\n+</script>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1736139478526,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,386 @@\n+<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css\">\n+<link href=\"https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css\" rel=\"stylesheet\">\n+<link rel=\"stylesheet\" href=\"{{ asset('admin/css/employee/style_edit.css') }}\">\n+<link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>\n+\n+<script src=\"https://cdn.jsdelivr.net/npm/sweetalert2@11\"></script>\n+\n+\n+<body>\n+    <div class=\"container\">\n+        <h1 style=\"text-align: left\">Chỉnh sửa thông tin hồ sơ</h1>\n+        <form id=\"updateProfile\" action=\"{{ route('employee.updateProfile') }}\" method=\"POST\" enctype=\"multipart/form-data\">\n+            @csrf\n+            @method('PUT')\n+            <!-- Cột bên trái (3/4) và cột bên phải (1/4) -->\n+            <div class=\"row mb-3\">\n+                <!-- Cột bên trái -->\n+                <div class=\"col-md-9\">\n+                    <!-- Mã KH + Mã số thuế + Tên KH -->\n+                    <div class=\"row mb-3\">\n+                        <div class=\"form-group col-md-4\">\n+                            <label for=\"username\" class=\"form-label\">Tên tài khoản<span class=\"required\">*</span></label>\n+                            <input type=\"text\" id=\"username\" name=\"username\" class=\"form-control\"\n+                                value=\"{{ $logged_user->user->username }}\" required>\n+                            <span class=\"error-message\" id=\"username_error\"></span>\n+                        </div>\n+                        <div class=\"form-group col-md-4\">\n+                            <label for=\"full_name\" class=\"form-label\">Tên nhân viên<span class=\"required\">*</span></label>\n+                            <input type=\"text\" id=\"full_name\" name=\"full_name\" class=\"form-control\"\n+                                value=\"{{ $logged_user->full_name }}\" required>\n+                            <span class=\"error-message\" id=\"full_name_error\"></span>\n+                        </div>\n+                        <div class=\"form-group col-md-4\">\n+                            <label for=\"gender\" class=\"form-label\">Giới tính<span class=\"required\">*</span></label>\n+                            <select id=\"gender\" name=\"gender\" class=\"form-control\" required>\n+                                <option value=\"Nam\" {{ $logged_user->gender == 'Nam' ? 'selected' : '' }}>Nam</option>\n+                                <option value=\"Nữ\" {{ $logged_user->gender == 'Nữ' ? 'selected' : '' }}>Nữ</option>\n+                            </select>\n+                        </div>\n+                    </div>\n+\n+                    <div class=\"row mb-3\">\n+                        <div class=\"form-group col-md-6 form-group-2\">\n+                            <label for=\"date_of_birth\" class=\"form-label\">Ngày sinh<span class=\"required\">*</span></label>\n+                            <input type=\"date\" id=\"date_of_birth\" name=\"date_of_birth\" class=\"form-control\"\n+                                value=\"{{ $logged_user->date_of_birth->toDateString() }}\" required>\n+                            <span class=\"error-message\" id=\"date_of_birth_error\"></span>\n+                        </div>\n+                        <div class=\"form-group col-md-6 form-group-2\">\n+                            <label for=\"phone\" class=\"form-label\">Số điện thoại<span class=\"required\">*</span></label>\n+                            <input type=\"text\" id=\"phone\" name=\"phone\" class=\"form-control\"\n+                                value=\"{{ $logged_user->phone }}\" required>\n+                            <span class=\"error-message\" id=\"phone_error\"></span>\n+                        </div>\n+\n+                    </div>\n+                    <div class=\"row mb-3\">\n+                        <div class=\"form-group col-md-6 form-group-3\">\n+                            <label for=\"email\" class=\"form-label\">Email<span class=\"required\">*</span></label>\n+                            <input type=\"text\" id=\"email\" name=\"email\" class=\"form-control\"\n+                                value=\"{{ $logged_user->email }}\" required>\n+                            <span class=\"error-message\" id=\"email_error\"></span>\n+                        </div>\n+                        <div class=\"form-group col-md-6 form-group-3\">\n+                            <label for=\"address\" class=\"form-label\">Địa chỉ<span class=\"required\">*</span></label>\n+                            <input type=\"text\" id=\"address\" name=\"address\" class=\"form-control\"\n+                                value=\"{{ $logged_user->address }}\" required>\n+                            <span class=\"error-message\" id=\"address_error\"></span>\n+                        </div>\n+                    </div>\n+                </div>\n+\n+                <!-- Cột bên phải cho hình ảnh đại diện -->\n+                <div class=\"col-md-3\">\n+                    <div class=\"container-img\">\n+                        <div class=\"form-group\">\n+                            <label for=\"profile_image\" class=\"form-label profile-image-label\">Ảnh đại diện</label>\n+                            <div class=\"custom-file-upload\">\n+                                <input type=\"file\" id=\"profile_image\" name=\"profile_image\" class=\"form-control\"\n+                                    accept=\"image/*\" onchange=\"previewImage(event)\">\n+                                <label for=\"profile_image\" class=\"custom-file-label\">Chọn khác</label>\n+\n+                                <div class=\"image-preview\">\n+                                    <div id=\"image-preview\" class=\"image-preview\">\n+                                        <img id=\"preview-img\"\n+                                            src=\"{{ $logged_user->profile_image ? asset('admin/img/employee/' . $logged_user->profile_image) : asset('admin/img/customer/default.png') }}\"\n+                                            alt=\"Hình đại diện\">\n+                                    </div>\n+                                </div>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </div>\n+            </div>\n+            <!-- Nút hành động -->\n+            <div class=\"button-container\">\n+                <button type=\"submit\" class=\"btn btn-edit me-3\">Cập nhật</button>\n+                <div class=\"btn btn-edit me-3\" id=\"openForm\">Thay đổi mật khẩu</div>\n+                <a href=\"{{ route('dashboard.index') }}\" class=\"btn btn-secondary\">Hủy</a>\n+            </div>\n+        </form>\n+    </div>\n+    <div class=\"modal-overlay\" id=\"modalOverlay\"></div>\n+    <div class=\"modal reset-password-box\" id=\"registrationForm\">\n+        <div class=\"reset-password-header\">\n+            <span>Đổi mật khẩu</span>\n+        </div>\n+        <form action=\"{{ route('employee.changePass') }}\" method=\"POST\" enctype=\"multipart/form-data\" class=\"reset-password-form\">\n+            @csrf\n+            @method('PUT')\n+\n+            <div class=\"input_box\">\n+                <input type=\"password\" name=\"old-password\" id=\"old-password\" class=\"input-field\" required>\n+                <label for=\"old-password\" class=\"label\">Mật khẩu cũ</label>\n+                <i class=\"bx bx-show toggle-password icon\" data-target=\"old-password\"></i>\n+                @if ($errors->has('old-password'))\n+                <div class=\"error-message\">{{ $errors->first('old-password') }}</div>\n+                @endif\n+            </div>\n+\n+            <div class=\"input_box\">\n+                <input type=\"password\" name=\"new-password\" id=\"new-password\" class=\"input-field\" value=\"{{ old('new-password') }}\" required>\n+                <label for=\"new-password\" class=\"label\">Mật khẩu mới</label>\n+                <i class=\"bx bx-show toggle-password icon\" data-target=\"new-password\"></i>\n+                <span class=\"error-message\" id=\"password_error\"></span>\n+                <div class=\"password-hint\">\n+                    <strong class=\"strong1\">Gợi ý để tạo mật khẩu an toàn:</strong>\n+                    <div class=\"hint-list\">\n+                        <ul class=\"ul-hint-list\">\n+                            <li class=\"hint\" id=\"hint_length\">Tối thiểu 8 ký tự</li>\n+                            <li class=\"hint\" id=\"hint_uppercase\">1 chữ cái in hoa</li>\n+                            <li class=\"hint\" id=\"hint_number\">1 số</li>\n+                            <li class=\"hint\" id=\"hint_special\">1 ký tự đặc biệt</li>\n+                            <li class=\"hint\" id=\"hint_lowercase\">1 chữ thường</li>\n+                        </ul>\n+                    </div>\n+                </div>\n+            </div>\n+\n+            <!-- Confirm Password -->\n+            <div class=\"input_box\">\n+                <input type=\"password\" name=\"confirm-password\" id=\"confirm-password\" class=\"input-field\" value=\"{{ old('confirm-password') }}\" required>\n+                <label for=\"confirm-password\" class=\"label\">Xác nhận mật khẩu</label>\n+                <i class=\"bx bx-show toggle-password icon\" data-target=\"confirm-password\"></i>\n+                <span class=\"error-message\" id=\"password_confirm_error\"></span>\n+            </div>\n+\n+            <!-- Submit Button -->\n+            <div class=\"input_box\">\n+                <input type=\"submit\" class=\"input-submit\" value=\"Cập nhật mật khẩu\">\n+            </div>\n+        </form>\n+    </div>\n+</body>\n+\n+<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js\"></script>\n+<script>\n+    function previewImage(event) {\n+        var reader = new FileReader();\n+        reader.onload = function() {\n+            var output = document.getElementById('preview-img');\n+            output.src = reader.result;\n+            output.style.display = 'block';\n+        };\n+        reader.readAsDataURL(event.target.files[0]);\n+    }\n+    @if(session('success'))\n+    document.addEventListener('DOMContentLoaded', function() {\n+        Swal.fire({\n+            title: 'Thành công!',\n+            text: \"{{ session('success') }}\",\n+            icon: 'success',\n+            confirmButtonText: 'OK'\n+        });\n+    });\n+    @endif\n+    document.addEventListener('DOMContentLoaded', function() {\n+        // Hiển thị modal nếu có lỗi từ server\n+        if (\"{{ $errors->any() }}\") {\n+            document.getElementById('registrationForm').style.display = 'block';\n+            document.getElementById('modalOverlay').style.display = 'block';\n+        }\n+\n+        const passwordInput = document.getElementById('new-password');\n+        const savedPassword = \"{{ old('new-password') }}\";\n+        const passwordConfirmInput = document.getElementById('confirm-password');\n+        const form = document.querySelector('.reset-password-form');\n+\n+        if (savedPassword) {\n+            updateHints(savedPassword);\n+        }\n+\n+        // Cập nhật gợi ý khi người dùng nhập mật khẩu mới\n+        passwordInput.addEventListener('input', function() {\n+            const passwordValue = passwordInput.value;\n+            updateHints(passwordValue);\n+        });\n+\n+        form.addEventListener('submit', function(e) {\n+            e.preventDefault();\n+            let hasError = false;\n+            // Password validation\n+            if (passwordInput.value.length < 8 || !/[A-Z]/.test(passwordInput.value) || !/[0-9]/.test(passwordInput.value) || !/[!@#$%^&*]/.test(passwordInput.value)) {\n+                document.getElementById('password_error').textContent = 'Mật khẩu yếu: phải chứa ít nhất 8 ký tự bao gồm chữ in hoa, số và ký tự đặc biệt.';\n+                hasError = true;\n+            }\n+\n+            // Password confirmation validation\n+            if (passwordInput.value !== passwordConfirmInput.value) {\n+                document.getElementById('password_confirm_error').textContent = 'Mật khẩu xác nhận không khớp.';\n+                hasError = true;\n+            }\n+\n+            // Nếu không có lỗi thì gửi form\n+            if (!hasError) {\n+                form.submit();\n+            }\n+        });\n+    });\n+    const openFormButton = document.getElementById('openForm');\n+    const modalPass = document.getElementById('registrationForm');\n+    const overlay = document.getElementById('modalOverlay');\n+    openFormButton.addEventListener('click', () => {\n+        modalPass.style.display = 'block';\n+        overlay.style.display = 'block';\n+\n+    });\n+\n+    overlay.addEventListener('click', () => {\n+        modalPass.style.display = 'none';\n+        overlay.style.display = 'none';\n+        const inputs = modalPass.querySelectorAll(\"input\");\n+        inputs.forEach(input => {\n+            if (input.type === \"submit\") {\n+                return;\n+            } else {\n+                input.value = \"\";\n+            }\n+        });\n+    });\n+\n+    document.querySelectorAll('.toggle-password').forEach(icon => {\n+        icon.addEventListener('click', () => {\n+            const targetId = icon.getAttribute('data-target');\n+            const targetInput = document.getElementById(targetId);\n+\n+            if (targetInput.type === 'password') {\n+                targetInput.type = 'text';\n+                icon.classList.remove('bx-show');\n+                icon.classList.add('bx-hide');\n+            } else {\n+                targetInput.type = 'password';\n+                icon.classList.remove('bx-hide');\n+                icon.classList.add('bx-show');\n+            }\n+        });\n+    });\n+\n+    function updateHints(passwordValue) {\n+        const errorMessage = document.getElementById('password_error');\n+\n+        // Reset màu sắc gợi ý\n+        document.querySelectorAll('.hint').forEach(hint => {\n+            hint.style.color = 'black';\n+        });\n+\n+        // Thay đổi màu sắc dựa trên điều kiện\n+        if (passwordValue.length >= 8) {\n+            document.getElementById('hint_length').style.color = 'orange';\n+        }\n+        if (/[A-Z]/.test(passwordValue)) {\n+            document.getElementById('hint_uppercase').style.color = 'orange';\n+        }\n+        if (/[0-9]/.test(passwordValue)) {\n+            document.getElementById('hint_number').style.color = 'orange';\n+        }\n+        if (/[!@#$%^&*]/.test(passwordValue)) {\n+            document.getElementById('hint_special').style.color = 'orange';\n+        }\n+        if (/[a-z]/.test(passwordValue)) {\n+            document.getElementById('hint_lowercase').style.color = 'orange';\n+        }\n+\n+        // Hiển thị thông báo lỗi nếu không đạt\n+        if (passwordValue.length < 8) {\n+            errorMessage.textContent = 'Mật khẩu phải có ít nhất 8 ký tự.';\n+        } else if (!/[A-Z]/.test(passwordValue)) {\n+            errorMessage.textContent = 'Mật khẩu phải có ít nhất một chữ cái viết hoa.';\n+        } else if (!/[0-9]/.test(passwordValue)) {\n+            errorMessage.textContent = 'Mật khẩu phải có ít nhất một số.';\n+        } else if (!/[!@#$%^&*]/.test(passwordValue)) {\n+            errorMessage.textContent = 'Mật khẩu phải có ít nhất một ký tự đặc biệt.';\n+        } else {\n+            errorMessage.textContent = '';\n+        }\n+    }\n+</script>\n+\n+<script>\n+    document.addEventListener('DOMContentLoaded', function() {\n+        const fullNameInput = document.getElementById('full_name');\n+        const phoneInput = document.getElementById('phone');\n+        const addressInput = document.getElementById('address');\n+        const dateOfBirthInput = document.getElementById('date_of_birth');\n+        const emailInput = document.getElementById('email');\n+        const usernameInput = document.getElementById('username');\n+        const form = document.getElementById('updateProfile');\n+\n+        function isValidEmail(email) {\n+            const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n+            return emailRegex.test(email);\n+        }\n+\n+        form.addEventListener('submit', function(e) {\n+            e.preventDefault();\n+            let hasError = false;\n+\n+            document.querySelectorAll('.error-message').forEach(error => {\n+                error.textContent = '';\n+            });\n+\n+            if (!/^[a-zA-ZÀ-ỹ\\s]+$/.test(fullNameInput.value.trim())) {\n+                document.getElementById('full_name_error').textContent = 'Họ và tên không được chứa số hoặc ký tự đặc biệt.';\n+                hasError = true;\n+            }\n+\n+            if (!/^\\d{10}$/.test(phoneInput.value.trim())) {\n+                document.getElementById('phone_error').textContent = 'Số điện thoại phải gồm 10 chữ số.';\n+                hasError = true;\n+            }\n+\n+            const dobValue = dateOfBirthInput.value;\n+            const [year, month, day] = dobValue.split('-').map(Number);\n+\n+            if (!year || !month || !day) {\n+                document.getElementById('date_of_birth_error').textContent = 'Vui lòng nhập đầy đủ ngày, tháng, năm.';\n+                hasError = true;\n+            } else if (year < 1900) {\n+                document.getElementById('date_of_birth_error').textContent = 'Năm sinh không hợp lệ (phải từ 1900 trở đi).';\n+                hasError = true;\n+            }\n+\n+            if (/^\\d+$/.test(addressInput.value.trim())) {\n+                document.getElementById('address_error').textContent = 'Địa chỉ không được chứa toàn là số.';\n+                hasError = true;\n+            }\n+\n+            if (!isValidEmail(emailInput.value.trim())) {\n+                document.getElementById('email_error').textContent = 'Email không hợp lệ.';\n+                hasError = true;\n+            }\n+\n+            if (!/^[a-zA-Z0-9]+$/.test(usernameInput.value.trim())) {\n+                document.getElementById('username_error').textContent = 'Tên đăng nhập chỉ được chứa chữ cái và số, không chứa dấu câu.';\n+                hasError = true;\n+            }\n+\n+            Promise.all([\n+                fetch(\"{{ route('resendOtp', ${emailInput.value.trim()}) }}\")\n+                .then(response => response.json())\n+                .then(data => {\n+                    if (data.exists) {\n+                        document.getElementById('email_error').textContent = 'Email đã tồn tại trong hệ thống. Vui lòng sử dụng email khác.';\n+                        hasError = true;\n+                    }\n+                }),\n+\n+                fetch(`/check-username-employee/${usernameInput.value.trim()}`)\n+                .then(response => response.json())\n+                .then(data => {\n+                    if (data.exists) {\n+                        document.getElementById('username_error').textContent = 'Tên đăng nhập đã tồn tại, vui lòng chọn tên khác.';\n+                        hasError = true;\n+                    }\n+                })\n+            ]).then(() => {\n+                if (!hasError) {\n+                    form.submit();\n+                }\n+            }).catch(error => {\n+                console.error('Lỗi khi kiểm tra thông tin:', error);\n+            });\n+\n+        });\n+    });\n+</script>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1736139571717,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,386 @@\n+<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css\">\n+<link href=\"https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css\" rel=\"stylesheet\">\n+<link rel=\"stylesheet\" href=\"{{ asset('admin/css/employee/style_edit.css') }}\">\n+<link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>\n+\n+<script src=\"https://cdn.jsdelivr.net/npm/sweetalert2@11\"></script>\n+\n+\n+<body>\n+    <div class=\"container\">\n+        <h1 style=\"text-align: left\">Chỉnh sửa thông tin hồ sơ</h1>\n+        <form id=\"updateProfile\" action=\"{{ route('employee.updateProfile') }}\" method=\"POST\" enctype=\"multipart/form-data\">\n+            @csrf\n+            @method('PUT')\n+            <!-- Cột bên trái (3/4) và cột bên phải (1/4) -->\n+            <div class=\"row mb-3\">\n+                <!-- Cột bên trái -->\n+                <div class=\"col-md-9\">\n+                    <!-- Mã KH + Mã số thuế + Tên KH -->\n+                    <div class=\"row mb-3\">\n+                        <div class=\"form-group col-md-4\">\n+                            <label for=\"username\" class=\"form-label\">Tên tài khoản<span class=\"required\">*</span></label>\n+                            <input type=\"text\" id=\"username\" name=\"username\" class=\"form-control\"\n+                                value=\"{{ $logged_user->user->username }}\" required>\n+                            <span class=\"error-message\" id=\"username_error\"></span>\n+                        </div>\n+                        <div class=\"form-group col-md-4\">\n+                            <label for=\"full_name\" class=\"form-label\">Tên nhân viên<span class=\"required\">*</span></label>\n+                            <input type=\"text\" id=\"full_name\" name=\"full_name\" class=\"form-control\"\n+                                value=\"{{ $logged_user->full_name }}\" required>\n+                            <span class=\"error-message\" id=\"full_name_error\"></span>\n+                        </div>\n+                        <div class=\"form-group col-md-4\">\n+                            <label for=\"gender\" class=\"form-label\">Giới tính<span class=\"required\">*</span></label>\n+                            <select id=\"gender\" name=\"gender\" class=\"form-control\" required>\n+                                <option value=\"Nam\" {{ $logged_user->gender == 'Nam' ? 'selected' : '' }}>Nam</option>\n+                                <option value=\"Nữ\" {{ $logged_user->gender == 'Nữ' ? 'selected' : '' }}>Nữ</option>\n+                            </select>\n+                        </div>\n+                    </div>\n+\n+                    <div class=\"row mb-3\">\n+                        <div class=\"form-group col-md-6 form-group-2\">\n+                            <label for=\"date_of_birth\" class=\"form-label\">Ngày sinh<span class=\"required\">*</span></label>\n+                            <input type=\"date\" id=\"date_of_birth\" name=\"date_of_birth\" class=\"form-control\"\n+                                value=\"{{ $logged_user->date_of_birth->toDateString() }}\" required>\n+                            <span class=\"error-message\" id=\"date_of_birth_error\"></span>\n+                        </div>\n+                        <div class=\"form-group col-md-6 form-group-2\">\n+                            <label for=\"phone\" class=\"form-label\">Số điện thoại<span class=\"required\">*</span></label>\n+                            <input type=\"text\" id=\"phone\" name=\"phone\" class=\"form-control\"\n+                                value=\"{{ $logged_user->phone }}\" required>\n+                            <span class=\"error-message\" id=\"phone_error\"></span>\n+                        </div>\n+\n+                    </div>\n+                    <div class=\"row mb-3\">\n+                        <div class=\"form-group col-md-6 form-group-3\">\n+                            <label for=\"email\" class=\"form-label\">Email<span class=\"required\">*</span></label>\n+                            <input type=\"text\" id=\"email\" name=\"email\" class=\"form-control\"\n+                                value=\"{{ $logged_user->email }}\" required>\n+                            <span class=\"error-message\" id=\"email_error\"></span>\n+                        </div>\n+                        <div class=\"form-group col-md-6 form-group-3\">\n+                            <label for=\"address\" class=\"form-label\">Địa chỉ<span class=\"required\">*</span></label>\n+                            <input type=\"text\" id=\"address\" name=\"address\" class=\"form-control\"\n+                                value=\"{{ $logged_user->address }}\" required>\n+                            <span class=\"error-message\" id=\"address_error\"></span>\n+                        </div>\n+                    </div>\n+                </div>\n+\n+                <!-- Cột bên phải cho hình ảnh đại diện -->\n+                <div class=\"col-md-3\">\n+                    <div class=\"container-img\">\n+                        <div class=\"form-group\">\n+                            <label for=\"profile_image\" class=\"form-label profile-image-label\">Ảnh đại diện</label>\n+                            <div class=\"custom-file-upload\">\n+                                <input type=\"file\" id=\"profile_image\" name=\"profile_image\" class=\"form-control\"\n+                                    accept=\"image/*\" onchange=\"previewImage(event)\">\n+                                <label for=\"profile_image\" class=\"custom-file-label\">Chọn khác</label>\n+\n+                                <div class=\"image-preview\">\n+                                    <div id=\"image-preview\" class=\"image-preview\">\n+                                        <img id=\"preview-img\"\n+                                            src=\"{{ $logged_user->profile_image ? asset('admin/img/employee/' . $logged_user->profile_image) : asset('admin/img/customer/default.png') }}\"\n+                                            alt=\"Hình đại diện\">\n+                                    </div>\n+                                </div>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </div>\n+            </div>\n+            <!-- Nút hành động -->\n+            <div class=\"button-container\">\n+                <button type=\"submit\" class=\"btn btn-edit me-3\">Cập nhật</button>\n+                <div class=\"btn btn-edit me-3\" id=\"openForm\">Thay đổi mật khẩu</div>\n+                <a href=\"{{ route('dashboard.index') }}\" class=\"btn btn-secondary\">Hủy</a>\n+            </div>\n+        </form>\n+    </div>\n+    <div class=\"modal-overlay\" id=\"modalOverlay\"></div>\n+    <div class=\"modal reset-password-box\" id=\"registrationForm\">\n+        <div class=\"reset-password-header\">\n+            <span>Đổi mật khẩu</span>\n+        </div>\n+        <form action=\"{{ route('employee.changePass') }}\" method=\"POST\" enctype=\"multipart/form-data\" class=\"reset-password-form\">\n+            @csrf\n+            @method('PUT')\n+\n+            <div class=\"input_box\">\n+                <input type=\"password\" name=\"old-password\" id=\"old-password\" class=\"input-field\" required>\n+                <label for=\"old-password\" class=\"label\">Mật khẩu cũ</label>\n+                <i class=\"bx bx-show toggle-password icon\" data-target=\"old-password\"></i>\n+                @if ($errors->has('old-password'))\n+                <div class=\"error-message\">{{ $errors->first('old-password') }}</div>\n+                @endif\n+            </div>\n+\n+            <div class=\"input_box\">\n+                <input type=\"password\" name=\"new-password\" id=\"new-password\" class=\"input-field\" value=\"{{ old('new-password') }}\" required>\n+                <label for=\"new-password\" class=\"label\">Mật khẩu mới</label>\n+                <i class=\"bx bx-show toggle-password icon\" data-target=\"new-password\"></i>\n+                <span class=\"error-message\" id=\"password_error\"></span>\n+                <div class=\"password-hint\">\n+                    <strong class=\"strong1\">Gợi ý để tạo mật khẩu an toàn:</strong>\n+                    <div class=\"hint-list\">\n+                        <ul class=\"ul-hint-list\">\n+                            <li class=\"hint\" id=\"hint_length\">Tối thiểu 8 ký tự</li>\n+                            <li class=\"hint\" id=\"hint_uppercase\">1 chữ cái in hoa</li>\n+                            <li class=\"hint\" id=\"hint_number\">1 số</li>\n+                            <li class=\"hint\" id=\"hint_special\">1 ký tự đặc biệt</li>\n+                            <li class=\"hint\" id=\"hint_lowercase\">1 chữ thường</li>\n+                        </ul>\n+                    </div>\n+                </div>\n+            </div>\n+\n+            <!-- Confirm Password -->\n+            <div class=\"input_box\">\n+                <input type=\"password\" name=\"confirm-password\" id=\"confirm-password\" class=\"input-field\" value=\"{{ old('confirm-password') }}\" required>\n+                <label for=\"confirm-password\" class=\"label\">Xác nhận mật khẩu</label>\n+                <i class=\"bx bx-show toggle-password icon\" data-target=\"confirm-password\"></i>\n+                <span class=\"error-message\" id=\"password_confirm_error\"></span>\n+            </div>\n+\n+            <!-- Submit Button -->\n+            <div class=\"input_box\">\n+                <input type=\"submit\" class=\"input-submit\" value=\"Cập nhật mật khẩu\">\n+            </div>\n+        </form>\n+    </div>\n+</body>\n+\n+<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js\"></script>\n+<script>\n+    function previewImage(event) {\n+        var reader = new FileReader();\n+        reader.onload = function() {\n+            var output = document.getElementById('preview-img');\n+            output.src = reader.result;\n+            output.style.display = 'block';\n+        };\n+        reader.readAsDataURL(event.target.files[0]);\n+    }\n+    @if(session('success'))\n+    document.addEventListener('DOMContentLoaded', function() {\n+        Swal.fire({\n+            title: 'Thành công!',\n+            text: \"{{ session('success') }}\",\n+            icon: 'success',\n+            confirmButtonText: 'OK'\n+        });\n+    });\n+    @endif\n+    document.addEventListener('DOMContentLoaded', function() {\n+        // Hiển thị modal nếu có lỗi từ server\n+        if (\"{{ $errors->any() }}\") {\n+            document.getElementById('registrationForm').style.display = 'block';\n+            document.getElementById('modalOverlay').style.display = 'block';\n+        }\n+\n+        const passwordInput = document.getElementById('new-password');\n+        const savedPassword = \"{{ old('new-password') }}\";\n+        const passwordConfirmInput = document.getElementById('confirm-password');\n+        const form = document.querySelector('.reset-password-form');\n+\n+        if (savedPassword) {\n+            updateHints(savedPassword);\n+        }\n+\n+        // Cập nhật gợi ý khi người dùng nhập mật khẩu mới\n+        passwordInput.addEventListener('input', function() {\n+            const passwordValue = passwordInput.value;\n+            updateHints(passwordValue);\n+        });\n+\n+        form.addEventListener('submit', function(e) {\n+            e.preventDefault();\n+            let hasError = false;\n+            // Password validation\n+            if (passwordInput.value.length < 8 || !/[A-Z]/.test(passwordInput.value) || !/[0-9]/.test(passwordInput.value) || !/[!@#$%^&*]/.test(passwordInput.value)) {\n+                document.getElementById('password_error').textContent = 'Mật khẩu yếu: phải chứa ít nhất 8 ký tự bao gồm chữ in hoa, số và ký tự đặc biệt.';\n+                hasError = true;\n+            }\n+\n+            // Password confirmation validation\n+            if (passwordInput.value !== passwordConfirmInput.value) {\n+                document.getElementById('password_confirm_error').textContent = 'Mật khẩu xác nhận không khớp.';\n+                hasError = true;\n+            }\n+\n+            // Nếu không có lỗi thì gửi form\n+            if (!hasError) {\n+                form.submit();\n+            }\n+        });\n+    });\n+    const openFormButton = document.getElementById('openForm');\n+    const modalPass = document.getElementById('registrationForm');\n+    const overlay = document.getElementById('modalOverlay');\n+    openFormButton.addEventListener('click', () => {\n+        modalPass.style.display = 'block';\n+        overlay.style.display = 'block';\n+\n+    });\n+\n+    overlay.addEventListener('click', () => {\n+        modalPass.style.display = 'none';\n+        overlay.style.display = 'none';\n+        const inputs = modalPass.querySelectorAll(\"input\");\n+        inputs.forEach(input => {\n+            if (input.type === \"submit\") {\n+                return;\n+            } else {\n+                input.value = \"\";\n+            }\n+        });\n+    });\n+\n+    document.querySelectorAll('.toggle-password').forEach(icon => {\n+        icon.addEventListener('click', () => {\n+            const targetId = icon.getAttribute('data-target');\n+            const targetInput = document.getElementById(targetId);\n+\n+            if (targetInput.type === 'password') {\n+                targetInput.type = 'text';\n+                icon.classList.remove('bx-show');\n+                icon.classList.add('bx-hide');\n+            } else {\n+                targetInput.type = 'password';\n+                icon.classList.remove('bx-hide');\n+                icon.classList.add('bx-show');\n+            }\n+        });\n+    });\n+\n+    function updateHints(passwordValue) {\n+        const errorMessage = document.getElementById('password_error');\n+\n+        // Reset màu sắc gợi ý\n+        document.querySelectorAll('.hint').forEach(hint => {\n+            hint.style.color = 'black';\n+        });\n+\n+        // Thay đổi màu sắc dựa trên điều kiện\n+        if (passwordValue.length >= 8) {\n+            document.getElementById('hint_length').style.color = 'orange';\n+        }\n+        if (/[A-Z]/.test(passwordValue)) {\n+            document.getElementById('hint_uppercase').style.color = 'orange';\n+        }\n+        if (/[0-9]/.test(passwordValue)) {\n+            document.getElementById('hint_number').style.color = 'orange';\n+        }\n+        if (/[!@#$%^&*]/.test(passwordValue)) {\n+            document.getElementById('hint_special').style.color = 'orange';\n+        }\n+        if (/[a-z]/.test(passwordValue)) {\n+            document.getElementById('hint_lowercase').style.color = 'orange';\n+        }\n+\n+        // Hiển thị thông báo lỗi nếu không đạt\n+        if (passwordValue.length < 8) {\n+            errorMessage.textContent = 'Mật khẩu phải có ít nhất 8 ký tự.';\n+        } else if (!/[A-Z]/.test(passwordValue)) {\n+            errorMessage.textContent = 'Mật khẩu phải có ít nhất một chữ cái viết hoa.';\n+        } else if (!/[0-9]/.test(passwordValue)) {\n+            errorMessage.textContent = 'Mật khẩu phải có ít nhất một số.';\n+        } else if (!/[!@#$%^&*]/.test(passwordValue)) {\n+            errorMessage.textContent = 'Mật khẩu phải có ít nhất một ký tự đặc biệt.';\n+        } else {\n+            errorMessage.textContent = '';\n+        }\n+    }\n+</script>\n+\n+<script>\n+    document.addEventListener('DOMContentLoaded', function() {\n+        const fullNameInput = document.getElementById('full_name');\n+        const phoneInput = document.getElementById('phone');\n+        const addressInput = document.getElementById('address');\n+        const dateOfBirthInput = document.getElementById('date_of_birth');\n+        const emailInput = document.getElementById('email');\n+        const usernameInput = document.getElementById('username');\n+        const form = document.getElementById('updateProfile');\n+\n+        function isValidEmail(email) {\n+            const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n+            return emailRegex.test(email);\n+        }\n+\n+        form.addEventListener('submit', function(e) {\n+            e.preventDefault();\n+            let hasError = false;\n+\n+            document.querySelectorAll('.error-message').forEach(error => {\n+                error.textContent = '';\n+            });\n+\n+            if (!/^[a-zA-ZÀ-ỹ\\s]+$/.test(fullNameInput.value.trim())) {\n+                document.getElementById('full_name_error').textContent = 'Họ và tên không được chứa số hoặc ký tự đặc biệt.';\n+                hasError = true;\n+            }\n+\n+            if (!/^\\d{10}$/.test(phoneInput.value.trim())) {\n+                document.getElementById('phone_error').textContent = 'Số điện thoại phải gồm 10 chữ số.';\n+                hasError = true;\n+            }\n+\n+            const dobValue = dateOfBirthInput.value;\n+            const [year, month, day] = dobValue.split('-').map(Number);\n+\n+            if (!year || !month || !day) {\n+                document.getElementById('date_of_birth_error').textContent = 'Vui lòng nhập đầy đủ ngày, tháng, năm.';\n+                hasError = true;\n+            } else if (year < 1900) {\n+                document.getElementById('date_of_birth_error').textContent = 'Năm sinh không hợp lệ (phải từ 1900 trở đi).';\n+                hasError = true;\n+            }\n+\n+            if (/^\\d+$/.test(addressInput.value.trim())) {\n+                document.getElementById('address_error').textContent = 'Địa chỉ không được chứa toàn là số.';\n+                hasError = true;\n+            }\n+\n+            if (!isValidEmail(emailInput.value.trim())) {\n+                document.getElementById('email_error').textContent = 'Email không hợp lệ.';\n+                hasError = true;\n+            }\n+\n+            if (!/^[a-zA-Z0-9]+$/.test(usernameInput.value.trim())) {\n+                document.getElementById('username_error').textContent = 'Tên đăng nhập chỉ được chứa chữ cái và số, không chứa dấu câu.';\n+                hasError = true;\n+            }\n+\n+            Promise.all([\n+                fetch(`/check-email-employee/${emailInput.value.trim()}`)\n+                .then(response => response.json())\n+                .then(data => {\n+                    if (data.exists) {\n+                        document.getElementById('email_error').textContent = 'Email đã tồn tại trong hệ thống. Vui lòng sử dụng email khác.';\n+                        hasError = true;\n+                    }\n+                }),\n+\n+                fetch(`/check-username-employee/${usernameInput.value.trim()}`)\n+                .then(response => response.json())\n+                .then(data => {\n+                    if (data.exists) {\n+                        document.getElementById('username_error').textContent = 'Tên đăng nhập đã tồn tại, vui lòng chọn tên khác.';\n+                        hasError = true;\n+                    }\n+                })\n+            ]).then(() => {\n+                if (!hasError) {\n+                    form.submit();\n+                }\n+            }).catch(error => {\n+                console.error('Lỗi khi kiểm tra thông tin:', error);\n+            });\n+\n+        });\n+    });\n+</script>\n\\ No newline at end of file\n"
                }
            ],
            "date": 1736139439269,
            "name": "Commit-0",
            "content": "<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css\">\n<link href=\"https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css\" rel=\"stylesheet\">\n<link rel=\"stylesheet\" href=\"{{ asset('admin/css/employee/style_edit.css') }}\">\n<link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>\n\n<script src=\"https://cdn.jsdelivr.net/npm/sweetalert2@11\"></script>\n\n\n<body>\n    <div class=\"container\">\n        <h1 style=\"text-align: left\">Chỉnh sửa thông tin hồ sơ</h1>\n        <form id=\"updateProfile\" action=\"{{ route('employee.updateProfile') }}\" method=\"POST\" enctype=\"multipart/form-data\">\n            @csrf\n            @method('PUT')\n            <!-- Cột bên trái (3/4) và cột bên phải (1/4) -->\n            <div class=\"row mb-3\">\n                <!-- Cột bên trái -->\n                <div class=\"col-md-9\">\n                    <!-- Mã KH + Mã số thuế + Tên KH -->\n                    <div class=\"row mb-3\">\n                        <div class=\"form-group col-md-4\">\n                            <label for=\"username\" class=\"form-label\">Tên tài khoản<span class=\"required\">*</span></label>\n                            <input type=\"text\" id=\"username\" name=\"username\" class=\"form-control\"\n                                value=\"{{ $logged_user->user->username }}\" required>\n                            <span class=\"error-message\" id=\"username_error\"></span>\n                        </div>\n                        <div class=\"form-group col-md-4\">\n                            <label for=\"full_name\" class=\"form-label\">Tên nhân viên<span class=\"required\">*</span></label>\n                            <input type=\"text\" id=\"full_name\" name=\"full_name\" class=\"form-control\"\n                                value=\"{{ $logged_user->full_name }}\" required>\n                            <span class=\"error-message\" id=\"full_name_error\"></span>\n                        </div>\n                        <div class=\"form-group col-md-4\">\n                            <label for=\"gender\" class=\"form-label\">Giới tính<span class=\"required\">*</span></label>\n                            <select id=\"gender\" name=\"gender\" class=\"form-control\" required>\n                                <option value=\"Nam\" {{ $logged_user->gender == 'Nam' ? 'selected' : '' }}>Nam</option>\n                                <option value=\"Nữ\" {{ $logged_user->gender == 'Nữ' ? 'selected' : '' }}>Nữ</option>\n                            </select>\n                        </div>\n                    </div>\n\n                    <div class=\"row mb-3\">\n                        <div class=\"form-group col-md-6 form-group-2\">\n                            <label for=\"date_of_birth\" class=\"form-label\">Ngày sinh<span class=\"required\">*</span></label>\n                            <input type=\"date\" id=\"date_of_birth\" name=\"date_of_birth\" class=\"form-control\"\n                                value=\"{{ $logged_user->date_of_birth->toDateString() }}\" required>\n                            <span class=\"error-message\" id=\"date_of_birth_error\"></span>\n                        </div>\n                        <div class=\"form-group col-md-6 form-group-2\">\n                            <label for=\"phone\" class=\"form-label\">Số điện thoại<span class=\"required\">*</span></label>\n                            <input type=\"text\" id=\"phone\" name=\"phone\" class=\"form-control\"\n                                value=\"{{ $logged_user->phone }}\" required>\n                            <span class=\"error-message\" id=\"phone_error\"></span>\n                        </div>\n\n                    </div>\n                    <div class=\"row mb-3\">\n                        <div class=\"form-group col-md-6 form-group-3\">\n                            <label for=\"email\" class=\"form-label\">Email<span class=\"required\">*</span></label>\n                            <input type=\"text\" id=\"email\" name=\"email\" class=\"form-control\"\n                                value=\"{{ $logged_user->email }}\" required>\n                            <span class=\"error-message\" id=\"email_error\"></span>\n                        </div>\n                        <div class=\"form-group col-md-6 form-group-3\">\n                            <label for=\"address\" class=\"form-label\">Địa chỉ<span class=\"required\">*</span></label>\n                            <input type=\"text\" id=\"address\" name=\"address\" class=\"form-control\"\n                                value=\"{{ $logged_user->address }}\" required>\n                            <span class=\"error-message\" id=\"address_error\"></span>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Cột bên phải cho hình ảnh đại diện -->\n                <div class=\"col-md-3\">\n                    <div class=\"container-img\">\n                        <div class=\"form-group\">\n                            <label for=\"profile_image\" class=\"form-label profile-image-label\">Ảnh đại diện</label>\n                            <div class=\"custom-file-upload\">\n                                <input type=\"file\" id=\"profile_image\" name=\"profile_image\" class=\"form-control\"\n                                    accept=\"image/*\" onchange=\"previewImage(event)\">\n                                <label for=\"profile_image\" class=\"custom-file-label\">Chọn khác</label>\n\n                                <div class=\"image-preview\">\n                                    <div id=\"image-preview\" class=\"image-preview\">\n                                        <img id=\"preview-img\"\n                                            src=\"{{ $logged_user->profile_image ? asset('admin/img/employee/' . $logged_user->profile_image) : asset('admin/img/customer/default.png') }}\"\n                                            alt=\"Hình đại diện\">\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <!-- Nút hành động -->\n            <div class=\"button-container\">\n                <button type=\"submit\" class=\"btn btn-edit me-3\">Cập nhật</button>\n                <div class=\"btn btn-edit me-3\" id=\"openForm\">Thay đổi mật khẩu</div>\n                <a href=\"{{ route('dashboard.index') }}\" class=\"btn btn-secondary\">Hủy</a>\n            </div>\n        </form>\n    </div>\n    <div class=\"modal-overlay\" id=\"modalOverlay\"></div>\n    <div class=\"modal reset-password-box\" id=\"registrationForm\">\n        <div class=\"reset-password-header\">\n            <span>Đổi mật khẩu</span>\n        </div>\n        <form action=\"{{ route('employee.changePass') }}\" method=\"POST\" enctype=\"multipart/form-data\" class=\"reset-password-form\">\n            @csrf\n            @method('PUT')\n\n            <div class=\"input_box\">\n                <input type=\"password\" name=\"old-password\" id=\"old-password\" class=\"input-field\" required>\n                <label for=\"old-password\" class=\"label\">Mật khẩu cũ</label>\n                <i class=\"bx bx-show toggle-password icon\" data-target=\"old-password\"></i>\n                @if ($errors->has('old-password'))\n                <div class=\"error-message\">{{ $errors->first('old-password') }}</div>\n                @endif\n            </div>\n\n            <div class=\"input_box\">\n                <input type=\"password\" name=\"new-password\" id=\"new-password\" class=\"input-field\" value=\"{{ old('new-password') }}\" required>\n                <label for=\"new-password\" class=\"label\">Mật khẩu mới</label>\n                <i class=\"bx bx-show toggle-password icon\" data-target=\"new-password\"></i>\n                <span class=\"error-message\" id=\"password_error\"></span>\n                <div class=\"password-hint\">\n                    <strong class=\"strong1\">Gợi ý để tạo mật khẩu an toàn:</strong>\n                    <div class=\"hint-list\">\n                        <ul class=\"ul-hint-list\">\n                            <li class=\"hint\" id=\"hint_length\">Tối thiểu 8 ký tự</li>\n                            <li class=\"hint\" id=\"hint_uppercase\">1 chữ cái in hoa</li>\n                            <li class=\"hint\" id=\"hint_number\">1 số</li>\n                            <li class=\"hint\" id=\"hint_special\">1 ký tự đặc biệt</li>\n                            <li class=\"hint\" id=\"hint_lowercase\">1 chữ thường</li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Confirm Password -->\n            <div class=\"input_box\">\n                <input type=\"password\" name=\"confirm-password\" id=\"confirm-password\" class=\"input-field\" value=\"{{ old('confirm-password') }}\" required>\n                <label for=\"confirm-password\" class=\"label\">Xác nhận mật khẩu</label>\n                <i class=\"bx bx-show toggle-password icon\" data-target=\"confirm-password\"></i>\n                <span class=\"error-message\" id=\"password_confirm_error\"></span>\n            </div>\n\n            <!-- Submit Button -->\n            <div class=\"input_box\">\n                <input type=\"submit\" class=\"input-submit\" value=\"Cập nhật mật khẩu\">\n            </div>\n        </form>\n    </div>\n</body>\n\n<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js\"></script>\n<script>\n    function previewImage(event) {\n        var reader = new FileReader();\n        reader.onload = function() {\n            var output = document.getElementById('preview-img');\n            output.src = reader.result;\n            output.style.display = 'block';\n        };\n        reader.readAsDataURL(event.target.files[0]);\n    }\n    @if(session('success'))\n    document.addEventListener('DOMContentLoaded', function() {\n        Swal.fire({\n            title: 'Thành công!',\n            text: \"{{ session('success') }}\",\n            icon: 'success',\n            confirmButtonText: 'OK'\n        });\n    });\n    @endif\n    document.addEventListener('DOMContentLoaded', function() {\n        // Hiển thị modal nếu có lỗi từ server\n        if (\"{{ $errors->any() }}\") {\n            document.getElementById('registrationForm').style.display = 'block';\n            document.getElementById('modalOverlay').style.display = 'block';\n        }\n\n        const passwordInput = document.getElementById('new-password');\n        const savedPassword = \"{{ old('new-password') }}\";\n        const passwordConfirmInput = document.getElementById('confirm-password');\n        const form = document.querySelector('.reset-password-form');\n\n        if (savedPassword) {\n            updateHints(savedPassword);\n        }\n\n        // Cập nhật gợi ý khi người dùng nhập mật khẩu mới\n        passwordInput.addEventListener('input', function() {\n            const passwordValue = passwordInput.value;\n            updateHints(passwordValue);\n        });\n\n        form.addEventListener('submit', function(e) {\n            e.preventDefault();\n            let hasError = false;\n            // Password validation\n            if (passwordInput.value.length < 8 || !/[A-Z]/.test(passwordInput.value) || !/[0-9]/.test(passwordInput.value) || !/[!@#$%^&*]/.test(passwordInput.value)) {\n                document.getElementById('password_error').textContent = 'Mật khẩu yếu: phải chứa ít nhất 8 ký tự bao gồm chữ in hoa, số và ký tự đặc biệt.';\n                hasError = true;\n            }\n\n            // Password confirmation validation\n            if (passwordInput.value !== passwordConfirmInput.value) {\n                document.getElementById('password_confirm_error').textContent = 'Mật khẩu xác nhận không khớp.';\n                hasError = true;\n            }\n\n            // Nếu không có lỗi thì gửi form\n            if (!hasError) {\n                form.submit();\n            }\n        });\n    });\n    const openFormButton = document.getElementById('openForm');\n    const modalPass = document.getElementById('registrationForm');\n    const overlay = document.getElementById('modalOverlay');\n    openFormButton.addEventListener('click', () => {\n        modalPass.style.display = 'block';\n        overlay.style.display = 'block';\n\n    });\n\n    overlay.addEventListener('click', () => {\n        modalPass.style.display = 'none';\n        overlay.style.display = 'none';\n        const inputs = modalPass.querySelectorAll(\"input\");\n        inputs.forEach(input => {\n            if (input.type === \"submit\") {\n                return;\n            } else {\n                input.value = \"\";\n            }\n        });\n    });\n\n    document.querySelectorAll('.toggle-password').forEach(icon => {\n        icon.addEventListener('click', () => {\n            const targetId = icon.getAttribute('data-target');\n            const targetInput = document.getElementById(targetId);\n\n            if (targetInput.type === 'password') {\n                targetInput.type = 'text';\n                icon.classList.remove('bx-show');\n                icon.classList.add('bx-hide');\n            } else {\n                targetInput.type = 'password';\n                icon.classList.remove('bx-hide');\n                icon.classList.add('bx-show');\n            }\n        });\n    });\n\n    function updateHints(passwordValue) {\n        const errorMessage = document.getElementById('password_error');\n\n        // Reset màu sắc gợi ý\n        document.querySelectorAll('.hint').forEach(hint => {\n            hint.style.color = 'black';\n        });\n\n        // Thay đổi màu sắc dựa trên điều kiện\n        if (passwordValue.length >= 8) {\n            document.getElementById('hint_length').style.color = 'orange';\n        }\n        if (/[A-Z]/.test(passwordValue)) {\n            document.getElementById('hint_uppercase').style.color = 'orange';\n        }\n        if (/[0-9]/.test(passwordValue)) {\n            document.getElementById('hint_number').style.color = 'orange';\n        }\n        if (/[!@#$%^&*]/.test(passwordValue)) {\n            document.getElementById('hint_special').style.color = 'orange';\n        }\n        if (/[a-z]/.test(passwordValue)) {\n            document.getElementById('hint_lowercase').style.color = 'orange';\n        }\n\n        // Hiển thị thông báo lỗi nếu không đạt\n        if (passwordValue.length < 8) {\n            errorMessage.textContent = 'Mật khẩu phải có ít nhất 8 ký tự.';\n        } else if (!/[A-Z]/.test(passwordValue)) {\n            errorMessage.textContent = 'Mật khẩu phải có ít nhất một chữ cái viết hoa.';\n        } else if (!/[0-9]/.test(passwordValue)) {\n            errorMessage.textContent = 'Mật khẩu phải có ít nhất một số.';\n        } else if (!/[!@#$%^&*]/.test(passwordValue)) {\n            errorMessage.textContent = 'Mật khẩu phải có ít nhất một ký tự đặc biệt.';\n        } else {\n            errorMessage.textContent = '';\n        }\n    }\n</script>\n\n<script>\n    document.addEventListener('DOMContentLoaded', function() {\n        const fullNameInput = document.getElementById('full_name');\n        const phoneInput = document.getElementById('phone');\n        const addressInput = document.getElementById('address');\n        const dateOfBirthInput = document.getElementById('date_of_birth');\n        const emailInput = document.getElementById('email');\n        const usernameInput = document.getElementById('username');\n        const form = document.getElementById('updateProfile');\n\n        function isValidEmail(email) {\n            const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n            return emailRegex.test(email);\n        }\n\n        form.addEventListener('submit', function(e) {\n            e.preventDefault();\n            let hasError = false;\n\n            document.querySelectorAll('.error-message').forEach(error => {\n                error.textContent = '';\n            });\n\n            if (!/^[a-zA-ZÀ-ỹ\\s]+$/.test(fullNameInput.value.trim())) {\n                document.getElementById('full_name_error').textContent = 'Họ và tên không được chứa số hoặc ký tự đặc biệt.';\n                hasError = true;\n            }\n\n            if (!/^\\d{10}$/.test(phoneInput.value.trim())) {\n                document.getElementById('phone_error').textContent = 'Số điện thoại phải gồm 10 chữ số.';\n                hasError = true;\n            }\n\n            const dobValue = dateOfBirthInput.value;\n            const [year, month, day] = dobValue.split('-').map(Number);\n\n            if (!year || !month || !day) {\n                document.getElementById('date_of_birth_error').textContent = 'Vui lòng nhập đầy đủ ngày, tháng, năm.';\n                hasError = true;\n            } else if (year < 1900) {\n                document.getElementById('date_of_birth_error').textContent = 'Năm sinh không hợp lệ (phải từ 1900 trở đi).';\n                hasError = true;\n            }\n\n            if (/^\\d+$/.test(addressInput.value.trim())) {\n                document.getElementById('address_error').textContent = 'Địa chỉ không được chứa toàn là số.';\n                hasError = true;\n            }\n\n            if (!isValidEmail(emailInput.value.trim())) {\n                document.getElementById('email_error').textContent = 'Email không hợp lệ.';\n                hasError = true;\n            }\n\n            if (!/^[a-zA-Z0-9]+$/.test(usernameInput.value.trim())) {\n                document.getElementById('username_error').textContent = 'Tên đăng nhập chỉ được chứa chữ cái và số, không chứa dấu câu.';\n                hasError = true;\n            }\n\n            Promise.all([\n                fetch({{ route('resendOtp', ${emailInput.value.trim()}) }}\"`/check-email-employee/${emailInput.value.trim()}`)\n                .then(response => response.json())\n                .then(data => {\n                    if (data.exists) {\n                        document.getElementById('email_error').textContent = 'Email đã tồn tại trong hệ thống. Vui lòng sử dụng email khác.';\n                        hasError = true;\n                    }\n                }),\n\n                fetch(`/check-username-employee/${usernameInput.value.trim()}`)\n                .then(response => response.json())\n                .then(data => {\n                    if (data.exists) {\n                        document.getElementById('username_error').textContent = 'Tên đăng nhập đã tồn tại, vui lòng chọn tên khác.';\n                        hasError = true;\n                    }\n                })\n            ]).then(() => {\n                if (!hasError) {\n                    form.submit();\n                }\n            }).catch(error => {\n                console.error('Lỗi khi kiểm tra thông tin:', error);\n            });\n\n        });\n    });\n</script>"
        }
    ]
}